<!DOCTYPE html>

<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>2. S4 Classes &mdash; R Tutorial</title>


  <link rel="stylesheet" href="static/css/theme.css" type="text/css" />


  <link rel="stylesheet" href="static/siteColours.css" type="text/css" />


  <link rel="top" title="R Tutorial" href="index.html" />
  <link rel="up" title="Object Oriented Programming" href="objectOriented.html" />
  <link rel="next" title="16. Case Study: Working Through a HW Problem" href="hwI.html" />
  <link rel="prev" title="1. S3 Classes" href="s3Classes.html" />


  <script src="static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">


    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">


          <a href="index.html" class="icon icon-home"> R Tutorial



          </a>


          <div class="version">
            3
          </div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">


          <div id="sidebar">
            <!-- localtoc.html -->
            <ul>
              <li><a class="reference internal" href="#">2. S4 Classes</a>
                <ul>
                  <li><a class="reference internal" href="#the-basic-idea">2.1. The Basic Idea</a></li>
                  <li><a class="reference internal" href="#creating-an-s4-class">2.2. Creating an S4 Class</a></li>
                  <li><a class="reference internal" href="#creating-methods">2.3. Creating Methods</a></li>
                  <li><a class="reference internal" href="#inheritance">2.4. Inheritance</a></li>
                </ul>
              </li>
            </ul>

            <!-- globaltoc.html -->
            <ul class="current">
              <li class="toctree-l1"><a class="reference internal" href="input.html">1. Input</a></li>
              <li class="toctree-l1"><a class="reference internal" href="types.html">2. Basic Data Types</a></li>
              <li class="toctree-l1"><a class="reference internal" href="basicOps.html">3. Basic Operations and Numerical Descriptions</a></li>
              <li class="toctree-l1"><a class="reference internal" href="probability.html">4. Basic Probability Distributions</a></li>
              <li class="toctree-l1"><a class="reference internal" href="plotting.html">5. Basic Plots</a></li>
              <li class="toctree-l1"><a class="reference internal" href="intermediatePlotting.html">6. Intermediate Plotting</a></li>
              <li class="toctree-l1"><a class="reference internal" href="vectorIndexing.html">7. Indexing Into Vectors</a></li>
              <li class="toctree-l1"><a class="reference internal" href="linearLeastSquares.html">8. Linear Least Squares Regression</a></li>
              <li class="toctree-l1"><a class="reference internal" href="confidence.html">9. Calculating Confidence Intervals</a></li>
              <li class="toctree-l1"><a class="reference internal" href="pValues.html">10. Calculating <em>p</em> Values</a></li>
              <li class="toctree-l1"><a class="reference internal" href="power.html">11. Calculating The Power Of A Test</a></li>
              <li class="toctree-l1"><a class="reference internal" href="tables.html">12. Two Way Tables</a></li>
              <li class="toctree-l1"><a class="reference internal" href="dataManagement.html">13. Data Management</a></li>
              <li class="toctree-l1"><a class="reference internal" href="time.html">14. Time Data Types</a></li>
              <li class="toctree-l1"><a class="reference internal" href="scripting.html">15. Introduction to Programming</a></li>
              <li class="toctree-l1 current"><a class="reference internal" href="objectOriented.html">Object Oriented Programming</a>
                <ul class="current">
                  <li class="toctree-l2"><a class="reference internal" href="s3Classes.html">1. S3 Classes</a></li>
                  <li class="toctree-l2 current"><a class="current reference internal" href="">2. S4 Classes</a>
                    <ul>
                      <li class="toctree-l3"><a class="reference internal" href="#the-basic-idea">2.1. The Basic Idea</a></li>
                      <li class="toctree-l3"><a class="reference internal" href="#creating-an-s4-class">2.2. Creating an S4 Class</a></li>
                      <li class="toctree-l3"><a class="reference internal" href="#creating-methods">2.3. Creating Methods</a></li>
                      <li class="toctree-l3"><a class="reference internal" href="#inheritance">2.4. Inheritance</a></li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li class="toctree-l1"><a class="reference internal" href="hwI.html">16. Case Study: Working Through a HW Problem</a></li>
              <li class="toctree-l1"><a class="reference internal" href="cholesterol.html">17. Case Study II: A JAMA Paper on Cholesterol</a></li>
            </ul>

          </div>


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">R Tutorial</a>
      </nav>


      <div class="wy-nav-content">
        <div class="rst-content">


          <div role="navigation" aria-label="breadcrumbs navigation">
            <ul class="wy-breadcrumbs">
              <li><a href="index.html">Docs</a> &raquo;</li>

              <li><a href="objectOriented.html">Object Oriented Programming</a> &raquo;</li>

              <li>2. S4 Classes</li>
              <li class="wy-breadcrumbs-aside">


              </li>
            </ul>
            <hr/>
          </div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">

              <div class="section" id="s4-classes">
                <h1>2. S4 Classes<a class="headerlink" href="#s4-classes" title="Permalink to this headline">¶</a></h1>
                <div class="contents local topic" id="contents">
                  <p class="topic-title first">Contents</p>
                  <ul class="simple">
                    <li><a class="reference internal" href="#the-basic-idea" id="id3">The Basic Idea</a></li>
                    <li><a class="reference internal" href="#creating-an-s4-class" id="id4">Creating an S4 Class</a></li>
                    <li><a class="reference internal" href="#creating-methods" id="id5">Creating Methods</a></li>
                    <li><a class="reference internal" href="#inheritance" id="id6">Inheritance</a></li>
                  </ul>
                </div>
                <span class="target" id="index-0"></span>
                <p id="index-1">We examine how to create S4 classes. It is assumed that you are familiar with the basic data types and scripting (<a class="reference internal" href="scripting.html#scripting"><span>Introduction to Programming</span></a>).</p>
                <div class="section" id="the-basic-idea">
                  <h2><a class="toc-backref" href="#id3">2.1. The Basic Idea</a><a class="headerlink" href="#the-basic-idea" title="Permalink to this headline">¶</a></h2>
                  <span class="target" id="index-2"></span>
                  <p id="index-3">The S4 approach differs from the S3 approach to creating a class in that it is a more rigid definition. The idea is that an object is created using the <em>setClass</em> command. The command takes a number of options. Many of the options
                    are not required, but we make use of several of the optional arguments because they represent good practices with respect to object oriented programming.</p>
                  <p>We first construct a trivial, contrived class simply to demonstrate the basic idea. Next we demonstrate how to create a method for an S4 class. This example is a little more involved than what we saw in the section on <a class="reference internal"
                      href="s3Classes.html#s3classesbasicidea"><span>S3 classes</span></a>.</p>
                  <p>In this example, the name of the class is <em>FirstQuadrant</em>, and the class is used to keep track of an <em>(x,y)</em> coordinate pair in the first quadrant. There is a restriction that both values must be greater than or equal to
                    zero. There are two data elements, called <em>slots</em>, and they are called <em>x</em> and <em>y</em>. The default values for the coordinate is the origin, <em>x=0</em> and <em>y=0</em>.</p>
                  <div class="highlight-r">
                    <div class="highlight"><pre><span></span><span class="c1">######################################################################</span>
<span class="c1"># Create the first quadrant class</span>
<span class="c1">#</span>
<span class="c1"># This is used to represent a coordinate in the first quadrant.</span>
FirstQuadrant <span class="o">&lt;-</span> setClass<span class="p">(</span>
        <span class="c1"># Set the name for the class</span>
        <span class="s">&quot;FirstQuadrant&quot;</span><span class="p">,</span>

        <span class="c1"># Define the slots</span>
        slots <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>
                x <span class="o">=</span> <span class="s">&quot;numeric&quot;</span><span class="p">,</span>
                y <span class="o">=</span> <span class="s">&quot;numeric&quot;</span>
                <span class="p">),</span>

        <span class="c1"># Set the default values for the slots. (optional)</span>
        prototype<span class="o">=</span><span class="kt">list</span><span class="p">(</span>
                x <span class="o">=</span> <span class="m">0.0</span><span class="p">,</span>
                y <span class="o">=</span> <span class="m">0.0</span>
                <span class="p">),</span>

        <span class="c1"># Make a function that can test to see if the data is consistent.</span>
        <span class="c1"># This is not called if you have an initialize function defined!</span>
        validity<span class="o">=</span><span class="kr">function</span><span class="p">(</span>object<span class="p">)</span>
        <span class="p">{</span>
                <span class="kr">if</span><span class="p">((</span>object<span class="o">@</span>x <span class="o">&lt;</span> <span class="m">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span>object<span class="o">@</span>y <span class="o">&lt;</span> <span class="m">0</span><span class="p">))</span> <span class="p">{</span>
                        <span class="kr">return</span><span class="p">(</span><span class="s">&quot;A negative number for one of the coordinates was given.&quot;</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="kr">return</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="p">)</span>
</pre></div>
                  </div>
                  <p>Note that the way to access one of the data elements is to use the &#8220;&#64;&#8221; symbol. An example if given below. In the example three elements of the class defined above are created. The first uses the default values for the
                    slots, the second overrides the defaults, and finally an attempt is made to create a coordinate in the second quadrant.</p>
                  <div class="highlight-rconsole">
                    <div class="highlight"><pre><span></span><span class="gp">&gt; </span>x <span class="o">&lt;-</span> FirstQuadrant<span class="p">()</span>
<span class="gp">&gt; </span>x
<span class="go">An object of class &quot;FirstQuadrant&quot;</span>
<span class="go">Slot &quot;x&quot;:</span>
<span class="go">[1] 0</span>

<span class="go">Slot &quot;y&quot;:</span>
<span class="go">[1] 0</span>

<span class="gp">&gt; </span>y <span class="o">&lt;-</span> FirstQuadrant<span class="p">(</span>x<span class="o">=</span><span class="m">5</span><span class="p">,</span>y<span class="o">=</span><span class="m">7</span><span class="p">)</span>
<span class="gp">&gt; </span>y
<span class="go">An object of class &quot;FirstQuadrant&quot;</span>
<span class="go">Slot &quot;x&quot;:</span>
<span class="go">[1] 5</span>

<span class="go">Slot &quot;y&quot;:</span>
<span class="go">[1] 7</span>

<span class="gp">&gt; </span>y<span class="o">@</span>x
<span class="go">[1] 5</span>
<span class="gp">&gt; </span>y<span class="o">@</span>y
<span class="go">[1] 7</span>
<span class="gp">&gt; </span>z <span class="o">&lt;-</span> FirstQuadrant<span class="p">(</span>x<span class="o">=</span><span class="m">3</span><span class="p">,</span>y<span class="o">=</span><span class="m">-2</span><span class="p">)</span>
<span class="go">Error in validObject(.Object) :</span>
<span class="go">      invalid class “FirstQuadrant” object: A negative number for one of the coordinates was given.</span>
<span class="gp">&gt; </span>z
<span class="go">Error: object &#39;z&#39; not found</span>
</pre></div>
                  </div>
                  <p>In the next example we create a method that is associated with the class. The method is used to set the values of a coordinate. The first step is to reserve the name using the <em>setGeneric</em> command, and then the <em>setMethod</em>                    command is used to define the function to be called when the first argument is an object from the <em>FirstQuadrant</em> class.</p>
                  <span class="target" id="index-4"></span>
                  <div class="highlight-r" id="index-5">
                    <div class="highlight"><pre><span></span><span class="c1"># create a method to assign the value of a coordinate</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;setCoordinate&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>xVal<span class="p">,</span>yVal<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;setCoordinate&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;setCoordinate&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;FirstQuadrant&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>xVal<span class="p">,</span>yVal<span class="p">)</span>
                      <span class="p">{</span>
                              theObject<span class="o">@</span>x <span class="o">&lt;-</span> xVal
                              theObject<span class="o">@</span>y <span class="o">&lt;-</span> yVal
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>
</pre></div>
                  </div>
                  <p>It is important to note that R generally passes objects as values. For this reason the methods defined above return the updated object. When the method is called, it is used to replace the former object with the updated object.</p>
                  <div class="highlight-rconsole">
                    <div class="highlight"><pre><span></span><span class="gp">&gt; </span>z <span class="o">&lt;-</span> FirstQuadrant<span class="p">(</span>x<span class="o">=</span><span class="m">2.5</span><span class="p">,</span>y<span class="o">=</span><span class="m">10</span><span class="p">)</span>
<span class="gp">&gt; </span>z
<span class="go">An object of class &quot;FirstQuadrant&quot;</span>
<span class="go">Slot &quot;x&quot;:</span>
<span class="go">[1] 2.5</span>

<span class="go">Slot &quot;y&quot;:</span>
<span class="go">[1] 10</span>

<span class="gp">&gt; </span>z <span class="o">&lt;-</span> setCoordinate<span class="p">(</span>z<span class="p">,</span><span class="m">-3.0</span><span class="p">,</span><span class="m">-5.0</span><span class="p">)</span>
<span class="gp">&gt; </span>z
<span class="go">An object of class &quot;FirstQuadrant&quot;</span>
<span class="go">Slot &quot;x&quot;:</span>
<span class="go">[1] -3</span>

<span class="go">Slot &quot;y&quot;:</span>
<span class="go">[1] -5</span>

</pre></div>
                  </div>
                  <p id="index-6">Note that the <em>validity</em> function given in the original class definition is not called. It is called when an object is first defined. It can be called later, but only when an explicit request is made using the <em>validObject</em>                    command.</p>
                </div>
                <div class="section" id="creating-an-s4-class">
                  <h2><a class="toc-backref" href="#id4">2.2. Creating an S4 Class</a><a class="headerlink" href="#creating-an-s4-class" title="Permalink to this headline">¶</a></h2>
                  <span class="target" id="index-7"></span><span class="target" id="index-8"></span><span class="target" id="index-9"></span><span class="target" id="index-10"></span><span class="target" id="index-11"></span><span class="target" id="index-12"></span>
                  <span
                    class="target" id="index-13"></span>
                    <p id="index-14">An S4 class is created using the <em>setClass()</em> command. At a minimum the name of the class is specified and the names of the data elements (slots) is specified. There are a number of other options, and just as a matter of good
                      practice we also specify a function to verify that the data is consistent (validation), and we specify the default values (the prototype). In the last section of this page,
                      <a class="reference internal" href="#s4inheritance"><span>S4 inheritance</span></a>, we include an additional parameter used to specify a class hierarchy.</p>
                    <p>In this section we look at another example, and we examine some of the functions associated with S4 classes. The example we define will be used to motivate the use of methods associated with a class, and it will be used to demonstrate
                      inheritance later. The idea is that we want to create a program to simulate a cellular automata model of a predator-prey system.</p>
                    <p>We do not develop the whole code here but concentrate on the data structures. In particular we will create a base class for the agents. In the next section we will create the basic methods for the class. In the inheritance section
                      we will discuss how to build on the class to create different predators and different prey species. The basic structure of the class is shown in <a class="reference internal" href="#s4-agent-class-diagram"><span>Figure 1.</span></a></p>
                    <div class="align-center figure" id="id1">
                      <span id="s4-agent-class-diagram"></span><img alt="Diagram of the base Agent class" src="images/s4AgentClass.png" />
                      <p class="caption"><span class="caption-text">Figure 1.</span></p>
                      <div class="legend">
                        Diagram of the base class, Agent, used for the agents in a simulation.</div>
                    </div>
                    <p>The methods for this class are defined in the following section. Here we define the class and its slots, and the code to define the class is given below:</p>
                    <div class="highlight-r">
                      <div class="highlight"><pre><span></span><span class="c1">######################################################################</span>
<span class="c1"># Create the base Agent class</span>
<span class="c1">#</span>
<span class="c1"># This is used to represent the most basic agent in a simulation.</span>
Agent <span class="o">&lt;-</span> setClass<span class="p">(</span>
        <span class="c1"># Set the name for the class</span>
        <span class="s">&quot;Agent&quot;</span><span class="p">,</span>

        <span class="c1"># Define the slots</span>
        slots <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>
                location <span class="o">=</span> <span class="s">&quot;numeric&quot;</span><span class="p">,</span>
                velocity   <span class="o">=</span> <span class="s">&quot;numeric&quot;</span><span class="p">,</span>
                active   <span class="o">=</span> <span class="s">&quot;logical&quot;</span>
                <span class="p">),</span>

        <span class="c1"># Set the default values for the slots. (optional)</span>
        prototype<span class="o">=</span><span class="kt">list</span><span class="p">(</span>
                location <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span><span class="m">0.0</span><span class="p">),</span>
                active   <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
                velocity <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span><span class="m">0.0</span><span class="p">)</span>
                <span class="p">),</span>

        <span class="c1"># Make a function that can test to see if the data is consistent.</span>
        <span class="c1"># This is not called if you have an initialize function defined!</span>
        validity<span class="o">=</span><span class="kr">function</span><span class="p">(</span>object<span class="p">)</span>
        <span class="p">{</span>
                <span class="kr">if</span><span class="p">(</span><span class="kp">sum</span><span class="p">(</span>object<span class="o">@</span>velocity<span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">&gt;</span><span class="m">100.0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kr">return</span><span class="p">(</span><span class="s">&quot;The velocity level is out of bounds.&quot;</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="kr">return</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="p">)</span>
</pre></div>
                    </div>
                    <p>Now that the code to define the class is given we can create an object whose class is Agent.</p>
                    <div class="highlight-rconsole">
                      <div class="highlight"><pre><span></span><span class="gp">&gt; </span>a <span class="o">&lt;-</span> Agent<span class="p">()</span>
<span class="gp">&gt; </span>a
<span class="go">An object of class &quot;Agent&quot;</span>
<span class="go">Slot &quot;location&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;velocity&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;active&quot;:</span>
<span class="go">[1] TRUE</span>

</pre></div>
                    </div>
                    <p>Before we define the methods for the class a number of additional commands are explored. The first set of functions explored are the
                      <em>is.object</em> and the <em>isS4</em> commands. The <em>is.object</em> command determines whether or not a variable refers to an object. The <em>isS4</em> command determines whether or not the variable is an S4 object. The reason
                      both are required is that the <em>isS4</em> command alone cannot determine if a variable is an S3 object. You need to determine if the variable is an object and then decide if it is S4 or not.</p>
                    <div class="highlight-rconsole">
                      <div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="kp">is.object</span><span class="p">(</span>a<span class="p">)</span>
<span class="go">[1] TRUE</span>
<span class="gp">&gt; </span><span class="kp">isS4</span><span class="p">(</span>a<span class="p">)</span>
<span class="go">[1] TRUE</span>
</pre></div>
                    </div>
                    <p>The next set of commands are used to get information about the data elements, or slots, within an object. The first is the <em>slotNames</em> command. This command can take either an object or the name of a class. It returns the names
                      of the slots associated with the class as strings.
                    </p>
                    <div class="highlight-rconsole">
                      <div class="highlight"><pre><span></span><span class="gp">&gt; </span>slotNames<span class="p">(</span>a<span class="p">)</span>
<span class="go">[1] &quot;location&quot; &quot;velocity&quot; &quot;active&quot;</span>
<span class="gp">&gt; </span>slotNames<span class="p">(</span><span class="s">&quot;Agent&quot;</span><span class="p">)</span>
<span class="go">[1] &quot;location&quot; &quot;velocity&quot; &quot;active&quot;</span>
</pre></div>
                    </div>
                    <p>The <em>getSlots</em> command is similar to the <em>slotNames</em> command. It takes the name of a class as a string. It returns a vector whose entries are the types associated with the slots, and the names of the entries are the names
                      of the slots.</p>
                    <div class="highlight-rconsole">
                      <div class="highlight"><pre><span></span><span class="gp">&gt; </span>getSlots<span class="p">(</span><span class="s">&quot;Agent&quot;</span><span class="p">)</span>
<span class="go">     location  velocity    active</span>
<span class="go">&quot;numeric&quot; &quot;numeric&quot; &quot;logical&quot;</span>
<span class="gp">&gt; </span>s <span class="o">&lt;-</span> getSlots<span class="p">(</span><span class="s">&quot;Agent&quot;</span><span class="p">)</span>
<span class="gp">&gt; </span>s<span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="go">     location</span>
<span class="go">&quot;numeric&quot;</span>
<span class="gp">&gt; </span>s<span class="p">[[</span><span class="m">1</span><span class="p">]]</span>
<span class="go">[1] &quot;numeric&quot;</span>
<span class="gp">&gt; </span><span class="kp">names</span><span class="p">(</span>s<span class="p">)</span>
<span class="go">[1] &quot;location&quot; &quot;velocity&quot; &quot;active&quot;</span>
</pre></div>
                    </div>
                    <p>The next command examined is the <em>getClass</em> command. It has two forms. If you give it a variable that is an S4 class it returns a list of slots for the class associated with the variable. If you give it a character string with
                      the name of a class it gives the slots and their data types.</p>
                    <div class="highlight-rconsole">
                      <div class="highlight"><pre><span></span><span class="gp">&gt; </span>getClass<span class="p">(</span>a<span class="p">)</span>
<span class="go">An object of class &quot;Agent&quot;</span>
<span class="go">Slot &quot;location&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;velocity&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;active&quot;:</span>
<span class="go">[1] TRUE</span>

<span class="gp">&gt; </span>getClass<span class="p">(</span><span class="s">&quot;Agent&quot;</span><span class="p">)</span>
<span class="go">Class &quot;Agent&quot; [in &quot;.GlobalEnv&quot;]</span>

<span class="go">Slots:</span>

<span class="go">Name:  location velocity   active</span>
<span class="go">Class:  numeric  numeric  logical</span>
</pre></div>
                    </div>
                    <p>The final command examined is the <em>slot</em> command. It can be used to get or set the value of a slot in an object. It can be used in place of the &#8220;&#64;&#8221; operator.</p>
                    <div class="highlight-rconsole">
                      <div class="highlight"><pre><span></span><span class="gp">&gt; </span>slot<span class="p">(</span>a<span class="p">,</span><span class="s">&quot;location&quot;</span><span class="p">)</span>
<span class="go">[1] 0 0</span>
<span class="gp">&gt; </span>slot<span class="p">(</span>a<span class="p">,</span><span class="s">&quot;location&quot;</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">5</span><span class="p">)</span>
<span class="gp">&gt; </span>a
<span class="go">An object of class &quot;Agent&quot;</span>
<span class="go">Slot &quot;location&quot;:</span>
<span class="go">[1] 1 5</span>

<span class="go">Slot &quot;velocity&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;active&quot;:</span>
<span class="go">[1] TRUE</span>

</pre></div>
                    </div>
                </div>
                <div class="section" id="creating-methods">
                  <h2><a class="toc-backref" href="#id5">2.3. Creating Methods</a><a class="headerlink" href="#creating-methods" title="Permalink to this headline">¶</a></h2>
                  <span class="target" id="index-15"></span><span class="target" id="index-16"></span><span class="target" id="index-17"></span><span class="target" id="index-18"></span><span class="target" id="index-19"></span>
                  <p id="index-20">We now build on the Agent class defined above. Once the class and its data elements are defined we can define the methods associated with the class. The basic idea is that if the name of a function has not been defined, the name must
                    first be reserved using the <em>setGeneric</em> function. The <em>setMethod</em> can then be used to define which function is called based on the class names of the objects sent to it.</p>
                  <p>We define the methods associated with the Agent method given in the previous section. Note that the <em>validity</em> function for an object is only called when it is first created and when an explicit call to the
                    <em>validObject</em> function is made. We make use of the <em>validObject</em> command in the methods below that are used to change the value of a data element within an object.</p>
                  <div class="highlight-r">
                    <div class="highlight"><pre><span></span><span class="c1"># create a method to assign the value of the location</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;setLocation&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>position<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;setLocation&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;setLocation&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>position<span class="p">)</span>
                      <span class="p">{</span>
                              theObject<span class="o">@</span>location <span class="o">&lt;-</span> position
                              validObject<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>

<span class="c1"># create a method to get the value of the location</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;getLocation&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;getLocation&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;getLocation&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">{</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="o">@</span>location<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>


<span class="c1"># create a method to assign the value of active</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;setActive&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>active<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;setActive&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;setActive&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>active<span class="p">)</span>
                      <span class="p">{</span>
                              theObject<span class="o">@</span>active <span class="o">&lt;-</span> active
                              validObject<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>

<span class="c1"># create a method to get the value of active</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;getActive&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;getActive&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;getActive&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">{</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="o">@</span>active<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>


<span class="c1"># create a method to assign the value of velocity</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;setVelocity&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>velocity<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;setVelocity&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;setVelocity&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>velocity<span class="p">)</span>
                      <span class="p">{</span>
                              theObject<span class="o">@</span>velocity <span class="o">&lt;-</span> velocity
                              validObject<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>

<span class="c1"># create a method to get the value of the velocity</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;getVelocity&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;getVelocity&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;getVelocity&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">{</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="o">@</span>velocity<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>
</pre></div>
                  </div>
                  <p>With these definitions the data elements are encapsulated and can be accessed and set using the methods given above. It is generally good practice in object oriented programming to keep your data private and not show them to everybody
                    willy nilly.</p>
                  <div class="highlight-rconsole">
                    <div class="highlight"><pre><span></span><span class="gp">&gt; </span>a <span class="o">&lt;-</span> Agent<span class="p">()</span>
<span class="gp">&gt; </span>getVelocity<span class="p">(</span>a<span class="p">)</span>
<span class="go">[1] 0 0</span>
<span class="gp">&gt; </span>a <span class="o">&lt;-</span> setVelocity<span class="p">(</span>a<span class="p">,</span><span class="kt">c</span><span class="p">(</span><span class="m">1.0</span><span class="p">,</span><span class="m">2.0</span><span class="p">))</span>
<span class="gp">&gt; </span>getVelocity<span class="p">(</span>a<span class="p">)</span>
<span class="go">[1] 1 2</span>
</pre></div>
                  </div>
                  <p>The last topic examined is the idea of overloading functions. In the examples above the signature is set to a single element. The signature is a vector of characters and specifies the data types of the argument list for the method to
                    be defined. Here we create two new methods. The name of the method is <em>resetActivity</em>, and there are two versions.</p>
                  <p>The first version accepts two arguments whose types are <em>Agent</em> and
                    <em>logical</em>. This version of the method will set the activity slot to a given value. The second version accepts two arguments whose types are
                    <em>Agent</em> and <em>numeric</em>. This version will set the activity to TRUE and then set the energy level to the value passed to it. Note that the names of the variables in the argument list must be exactly the same.</p>
                  <div class="highlight-r">
                    <div class="highlight"><pre><span></span><span class="c1"># create a method to reset the velocity and the activity</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;resetActivity&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>value<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;resetActivity&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;resetActivity&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span><span class="s">&quot;logical&quot;</span><span class="p">),</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>value<span class="p">)</span>
                      <span class="p">{</span>
                              theObject <span class="o">&lt;-</span> setActive<span class="p">(</span>theObject<span class="p">,</span>value<span class="p">)</span>
                              theObject <span class="o">&lt;-</span> setVelocity<span class="p">(</span>theObject<span class="p">,</span><span class="kt">c</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span><span class="m">0.0</span><span class="p">))</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;resetActivity&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span><span class="s">&quot;numeric&quot;</span><span class="p">),</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">,</span>value<span class="p">)</span>
                      <span class="p">{</span>
                              theObject <span class="o">&lt;-</span> setActive<span class="p">(</span>theObject<span class="p">,</span><span class="kc">TRUE</span><span class="p">)</span>
                              theObject <span class="o">&lt;-</span> setVelocity<span class="p">(</span>theObject<span class="p">,</span>value<span class="p">)</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>
</pre></div>
                  </div>
                  <p>This definition of the function yields two options for the
                    <em>resetActivity</em> function. The decision to determine which function to call depends on two arguments and their type. For example, if the first argument is from the Agent class and the second is a value of TRUE or FALSE, then
                    the first version of the function is called. Otherwise, if the second argument is a number the second version of the function is called.</p>
                  <div class="highlight-rconsole">
                    <div class="highlight"><pre><span></span><span class="gp">&gt; </span>a <span class="o">&lt;-</span> Agent<span class="p">()</span>
<span class="gp">&gt; </span>a
<span class="go">An object of class &quot;Agent&quot;</span>
<span class="go">Slot &quot;location&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;velocity&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;active&quot;:</span>
<span class="go">[1] TRUE</span>

<span class="gp">&gt; </span>a <span class="o">&lt;-</span> resetActivity<span class="p">(</span>a<span class="p">,</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="gp">&gt; </span>getActive<span class="p">(</span>a<span class="p">)</span>
<span class="go">[1] FALSE</span>
<span class="gp">&gt; </span> a <span class="o">&lt;-</span> resetActivity<span class="p">(</span>a<span class="p">,</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="gp">&gt; </span>getVelocity<span class="p">(</span>a<span class="p">)</span>
<span class="go">[1] 1 3</span>
</pre></div>
                  </div>
                </div>
                <div class="section" id="inheritance">
                  <span id="s4inheritance"></span>
                  <h2><a class="toc-backref" href="#id6">2.4. Inheritance</a><a class="headerlink" href="#inheritance" title="Permalink to this headline">¶</a></h2>
                  <span class="target" id="index-21"></span>
                  <p id="index-22">A class&#8217; inheritance hiearchy can be specified when the class is defined using the <em>contains</em> option. The <em>contains</em> option is a vector that lists the classes the new class inherits from. In the following example
                    we build on the Agent class defined in the previous section. The idea is that we need agents that represent a predator and two prey. We will focus on two predators for this example.</p>
                  <p>The hierarchy for the classes is shown in
                    <a class="reference internal" href="#s4-pred-prey-class-diagram"><span>Figure 2.</span></a>. In this example we have one Prey class that is derived from the Agent class. There are two predator classes, Bobcat and Lynx. The Bobcat class
                    is derived from the Agent class, and the Lynx class is derived from the Bobcat class. We will keep this very simple, and the only methods associated with the new classes is a <em>move</em> method. For our purposes it will only print
                    out a message and set the values of the position and velocity to demonstrate the order of execution of the methods associated with the classes.</p>
                  <div class="align-center figure" id="id2">
                    <span id="s4-pred-prey-class-diagram"></span><img alt="Diagram of the predator and prey classes derived from the Agent class." src="images/s4AgentPredPrey.png" />
                    <p class="caption"><span class="caption-text">Figure 2.</span></p>
                    <div class="legend">
                      Diagram of the predator and prey classes derived from the Agent class.</div>
                  </div>
                  <p>The first step is to create the three new classes.</p>
                  <div class="highlight-r">
                    <div class="highlight"><pre><span></span><span class="c1">######################################################################</span>
<span class="c1"># Create the Prey class</span>
<span class="c1">#</span>
<span class="c1"># This is used to represent a prey animal</span>
Prey <span class="o">&lt;-</span> setClass<span class="p">(</span>
        <span class="c1"># Set the name for the class</span>
        <span class="s">&quot;Prey&quot;</span><span class="p">,</span>

        <span class="c1"># Define the slots - in this case it is empty...</span>
        slots <span class="o">=</span> <span class="kt">character</span><span class="p">(</span><span class="m">0</span><span class="p">),</span>

        <span class="c1"># Set the default values for the slots. (optional)</span>
        prototype<span class="o">=</span><span class="kt">list</span><span class="p">(),</span>

        <span class="c1"># Make a function that can test to see if the data is consistent.</span>
        <span class="c1"># This is not called if you have an initialize function defined!</span>
        validity<span class="o">=</span><span class="kr">function</span><span class="p">(</span>object<span class="p">)</span>
        <span class="p">{</span>
                <span class="kr">if</span><span class="p">(</span><span class="kp">sum</span><span class="p">(</span>object<span class="o">@</span>velocity<span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">&gt;</span><span class="m">70.0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kr">return</span><span class="p">(</span><span class="s">&quot;The velocity level is out of bounds.&quot;</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="kr">return</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
        <span class="p">},</span>

        <span class="c1"># Set the inheritance for this class</span>
        contains <span class="o">=</span> <span class="s">&quot;Agent&quot;</span>
        <span class="p">)</span>



<span class="c1">######################################################################</span>
<span class="c1"># Create the Bobcat class</span>
<span class="c1">#</span>
<span class="c1"># This is used to represent a smaller predator</span>
Bobcat <span class="o">&lt;-</span> setClass<span class="p">(</span>
        <span class="c1"># Set the name for the class</span>
        <span class="s">&quot;Bobcat&quot;</span><span class="p">,</span>

        <span class="c1"># Define the slots - in this case it is empty...</span>
        slots <span class="o">=</span> <span class="kt">character</span><span class="p">(</span><span class="m">0</span><span class="p">),</span>

        <span class="c1"># Set the default values for the slots. (optional)</span>
        prototype<span class="o">=</span><span class="kt">list</span><span class="p">(),</span>

        <span class="c1"># Make a function that can test to see if the data is consistent.</span>
        <span class="c1"># This is not called if you have an initialize function defined!</span>
        validity<span class="o">=</span><span class="kr">function</span><span class="p">(</span>object<span class="p">)</span>
        <span class="p">{</span>
                <span class="kr">if</span><span class="p">(</span><span class="kp">sum</span><span class="p">(</span>object<span class="o">@</span>velocity<span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">&gt;</span><span class="m">85.0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kr">return</span><span class="p">(</span><span class="s">&quot;The velocity level is out of bounds.&quot;</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="kr">return</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
        <span class="p">},</span>

        <span class="c1"># Set the inheritance for this class</span>
        contains <span class="o">=</span> <span class="s">&quot;Agent&quot;</span>
        <span class="p">)</span>

<span class="c1">######################################################################</span>
<span class="c1"># Create the Lynx class</span>
<span class="c1">#</span>
<span class="c1"># This is used to represent a larger predator</span>
Lynx <span class="o">&lt;-</span> setClass<span class="p">(</span>
        <span class="c1"># Set the name for the class</span>
        <span class="s">&quot;Lynx&quot;</span><span class="p">,</span>

        <span class="c1"># Define the slots - in this case it is empty...</span>
        slots <span class="o">=</span> <span class="kt">character</span><span class="p">(</span><span class="m">0</span><span class="p">),</span>

        <span class="c1"># Set the default values for the slots. (optional)</span>
        prototype<span class="o">=</span><span class="kt">list</span><span class="p">(),</span>

        <span class="c1"># Make a function that can test to see if the data is consistent.</span>
        <span class="c1"># This is not called if you have an initialize function defined!</span>
        validity<span class="o">=</span><span class="kr">function</span><span class="p">(</span>object<span class="p">)</span>
        <span class="p">{</span>
                <span class="kr">if</span><span class="p">(</span><span class="kp">sum</span><span class="p">(</span>object<span class="o">@</span>velocity<span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">&gt;</span><span class="m">95.0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kr">return</span><span class="p">(</span><span class="s">&quot;The velocity level is out of bounds.&quot;</span><span class="p">)</span>
                <span class="p">}</span>
                <span class="kr">return</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
        <span class="p">},</span>

        <span class="c1"># Set the inheritance for this class</span>
        contains <span class="o">=</span> <span class="s">&quot;Bobcat&quot;</span>
        <span class="p">)</span>
</pre></div>
                  </div>
                  <p>The inheritance is specified using the <em>contains</em> option in the
                    <em>setClass</em> command. Note that this can be a vector allowing for multiple inheritance. We choose not to use that to keep things simpler. If you are feeling like you need more self-loathing in your life you should try it out and
                    experiment.</p>
                  <p>Next we define a method, <em>move</em>, for the new classes. We will include methods for the Agent, Prey, Bobcat, and Lynx classes. The methods do not really do anything but are used to demonstrate the idea of how methods are executed.</p>
                  <div class="highlight-r">
                    <div class="highlight"><pre><span></span><span class="c1"># create a method to move the agent.</span>
setGeneric<span class="p">(</span>name<span class="o">=</span><span class="s">&quot;move&quot;</span><span class="p">,</span>
                       def<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                       <span class="p">{</span>
                               <span class="kp">standardGeneric</span><span class="p">(</span><span class="s">&quot;move&quot;</span><span class="p">)</span>
                       <span class="p">}</span>
                       <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;move&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Agent&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">{</span>
                              <span class="kp">print</span><span class="p">(</span><span class="s">&quot;Move this Agent dude&quot;</span><span class="p">)</span>
                              theObject <span class="o">&lt;-</span> setVelocity<span class="p">(</span>theObject<span class="p">,</span><span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
                              validObject<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;move&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Prey&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">{</span>
                              <span class="kp">print</span><span class="p">(</span><span class="s">&quot;Check this Prey before moving this dude&quot;</span><span class="p">)</span>
                              theObject <span class="o">&lt;-</span> callNextMethod<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kp">print</span><span class="p">(</span><span class="s">&quot;Move this Prey dude&quot;</span><span class="p">)</span>
                              validObject<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;move&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Bobcat&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">{</span>
                              <span class="kp">print</span><span class="p">(</span><span class="s">&quot;Check this Bobcat before moving this dude&quot;</span><span class="p">)</span>
                              theObject <span class="o">&lt;-</span> setLocation<span class="p">(</span>theObject<span class="p">,</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
                              theObject <span class="o">&lt;-</span> callNextMethod<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kp">print</span><span class="p">(</span><span class="s">&quot;Move this Bobcat dude&quot;</span><span class="p">)</span>
                              validObject<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>

setMethod<span class="p">(</span>f<span class="o">=</span><span class="s">&quot;move&quot;</span><span class="p">,</span>
                      signature<span class="o">=</span><span class="s">&quot;Lynx&quot;</span><span class="p">,</span>
                      definition<span class="o">=</span><span class="kr">function</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">{</span>
                              <span class="kp">print</span><span class="p">(</span><span class="s">&quot;Check this Lynx before moving this dude&quot;</span><span class="p">)</span>
                              theObject <span class="o">&lt;-</span> setActive<span class="p">(</span>theObject<span class="p">,</span><span class="kc">FALSE</span><span class="p">)</span>
                              theObject <span class="o">&lt;-</span> callNextMethod<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kp">print</span><span class="p">(</span><span class="s">&quot;Move this Lynx dude&quot;</span><span class="p">)</span>
                              validObject<span class="p">(</span>theObject<span class="p">)</span>
                              <span class="kr">return</span><span class="p">(</span>theObject<span class="p">)</span>
                      <span class="p">}</span>
                      <span class="p">)</span>
</pre></div>
                  </div>
                  <p>There are a number of things to note. First each method calls the
                    <em>callNextMethod</em> command. This command will execute the next version of the same method for the previous class in the hierarchy. Note that I have included the arguments (in the same order) as those called by the original function.
                    Also note that the function returns a copy of the object and is used to update the object passed to the original function.
                  </p>
                  <p>Another thing to note is that the methods associated with the Lync, Bobcat, and Agent classes arbitrarily change the values of the position, velocity, and activity for the given object. This is done to demonstrate the changes that take
                    place and reinforce the necessity for using the <em>callNextMethod</em> function the way it is used here.</p>
                  <p>Finally, it should be noted that the <em>validObject</em> command is called in every method. You should try adding a print statement in the validity function. You might find that the order is a bit odd. You should experiment with this
                    and play with it. There are times you do not get the expected results so be careful!</p>
                  <p>We now give a brief example to demonstrate the order that the functions are called. In the example we create a Bobcat object and then call the <em>move</em> method. We next create a Lynx object and do the same. We print out the slots
                    for both agents just to demonstrate the values that are changed.</p>
                  <div class="highlight-rconsole">
                    <div class="highlight"><pre><span></span><span class="gp">&gt; </span>robert <span class="o">&lt;-</span> Bobcat<span class="p">()</span>
<span class="gp">&gt; </span>robert
<span class="go">An object of class &quot;Bobcat&quot;</span>
<span class="go">Slot &quot;location&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;velocity&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;active&quot;:</span>
<span class="go">[1] TRUE</span>

<span class="gp">&gt; </span>robert <span class="o">&lt;-</span> move<span class="p">(</span>robert<span class="p">)</span>
<span class="go">[1] &quot;Check this Bobcat before moving this dude&quot;</span>
<span class="go">[1] &quot;Move this Agent dude&quot;</span>
<span class="go">[1] &quot;Move this Bobcat dude&quot;</span>
<span class="gp">&gt; </span>robert
<span class="go">An object of class &quot;Bobcat&quot;</span>
<span class="go">Slot &quot;location&quot;:</span>
<span class="go">[1] 2 3</span>

<span class="go">Slot &quot;velocity&quot;:</span>
<span class="go">[1] 1 2</span>

<span class="go">Slot &quot;active&quot;:</span>
<span class="go">[1] TRUE</span>

<span class="gp">&gt;</span>
<span class="gp">&gt;</span>
<span class="gp">&gt;</span>
<span class="gp">&gt; </span>lionel <span class="o">&lt;-</span> Lynx<span class="p">()</span>
<span class="gp">&gt; </span>lionel
<span class="go">An object of class &quot;Lynx&quot;</span>
<span class="go">Slot &quot;location&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;velocity&quot;:</span>
<span class="go">[1] 0 0</span>

<span class="go">Slot &quot;active&quot;:</span>
<span class="go">[1] TRUE</span>

<span class="gp">&gt; </span>lionel <span class="o">&lt;-</span> move<span class="p">(</span>lionel<span class="p">)</span>
<span class="go">[1] &quot;Check this Lynx before moving this dude&quot;</span>
<span class="go">[1] &quot;Check this Bobcat before moving this dude&quot;</span>
<span class="go">[1] &quot;Move this Agent dude&quot;</span>
<span class="go">[1] &quot;Move this Bobcat dude&quot;</span>
<span class="go">[1] &quot;Move this Lynx dude&quot;</span>
<span class="gp">&gt; </span>lionel
<span class="go">An object of class &quot;Lynx&quot;</span>
<span class="go">Slot &quot;location&quot;:</span>
<span class="go">[1] 2 3</span>

<span class="go">Slot &quot;velocity&quot;:</span>
<span class="go">[1] 1 2</span>

<span class="go">Slot &quot;active&quot;:</span>
<span class="go">[1] FALSE</span>

</pre></div>
                  </div>
                </div>
              </div>


            </div>
          </div>


          <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">

            <a href="hwI.html" class="btn btn-neutral float-right" title="16. Case Study: Working Through a HW Problem" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>


            <a href="s3Classes.html" class="btn btn-neutral" title="1. S3 Classes" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>

          </div>


          <br><br>

          <div class="admonition note">
            <p class="first admonition-title">Sponsorship</p>
            <p class="last">
              This site generously supported by <a href="https://www.datacamp.com/" target="_blank">Datacamp</a>. Datacamp offers a free <a href="https://www.datacamp.com/courses/free-introduction-to-r" target="_blank"> interactive introduction to R coding tutorial</a>              as an additional resource. Already over 100,000 people took this free tutorial to sharpen their R coding skills.
            </p>
          </div>


          <footer>
            <hr/>

            <div role="contentinfo">

              <p>
                <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/"
                  href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">R Tutorial</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="mailto:kjblack@gmail.com" property="cc:attributionName" rel="cc:attributionURL">Kelly Black</a>                is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a> (2015).<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/"
                  href="http://www.cyclismo.org/tutorial/R/" rel="dct:source">http://www.cyclismo.org/tutorial/R/</a>.
              </p>

              </p>
            </div>
            Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

          </footer>

        </div>
      </div>

    </section>

  </div>


  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT: './',
      VERSION: '3.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE: true
    };
  </script>
  <script type="text/javascript" src="static/jquery.js"></script>
  <script type="text/javascript" src="static/underscore.js"></script>
  <script type="text/javascript" src="static/doctools.js"></script>
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  <script type="text/javascript" src="static/js/theme.js"></script>


  <script type="text/javascript">
    jQuery(function() {
      SphinxRtdTheme.StickyNav.enable();
    });
  </script>


</body>

</html>
